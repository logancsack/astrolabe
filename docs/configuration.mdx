---
title: "Configuration"
description: "Configure Astrolabe 0.2.0-beta.1 routing policy, safety gates, and escalation behavior."
---

Astrolabe config is environment-driven, with routing policy definitions in `server.js`.

## Routing profile

```bash
ASTROLABE_ROUTING_PROFILE=balanced
```

Supported values:

- `balanced` (default): normal policy behavior
- `budget`: cost-biased for lower-risk categories
- `quality`: quality-biased (complexity nudged up one level)

## Safety gate controls

```bash
ASTROLABE_ENABLE_SAFETY_GATE=true
ASTROLABE_HIGH_STAKES_CONFIRM_MODE=prompt
ASTROLABE_HIGH_STAKES_CONFIRM_TOKEN=confirm
ASTROLABE_ALLOW_HIGH_STAKES_BUDGET_FLOOR=false
```

- `ASTROLABE_ENABLE_SAFETY_GATE`: enables high-stakes detection pre-classification
- `ASTROLABE_HIGH_STAKES_CONFIRM_MODE`:
  - `prompt`: inject safety system policy into high-stakes requests
  - `strict`: block high-stakes requests unless exact confirmation token is present
  - `off`: disable confirmation behavior
- `ASTROLABE_HIGH_STAKES_CONFIRM_TOKEN`: exact token required in `x-astrolabe-confirmed` or `metadata.astrolabe_confirmed`
- `ASTROLABE_ALLOW_HIGH_STAKES_BUDGET_FLOOR`: allows Sonnet floor in budget profile for high-stakes category

## Classifier and self-check models

```bash
ASTROLABE_CLASSIFIER_MODEL_KEY=nano
ASTROLABE_SELF_CHECK_MODEL_KEY=nano
```

Model keys are defined in `MODELS`:

- `nano`
- `grok`
- `sonnet`
- `opus`
- `dsCoder`
- `gemFlash`
- `gem31Pro`

## Classifier context window

```bash
ASTROLABE_CONTEXT_MESSAGES=8
ASTROLABE_CONTEXT_CHARS=2500
```

These bounds control how much recent chat context is included in classifier prompts.

## Force-model override

```bash
ASTROLABE_FORCE_MODEL=anthropic/claude-opus-4.6
```

When set, Astrolabe bypasses route selection and forwards all requests to this model id.

## OpenRouter metadata headers

```bash
OPENROUTER_SITE_URL=https://your-site.example
OPENROUTER_APP_NAME=Astrolabe
```

## Cost estimates

Cost logs rely on `pricePer1M` in `server.js`, keyed by full model id. Update this table whenever provider pricing changes.
